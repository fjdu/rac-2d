module load_Visser_CO_selfshielding

use trivials

! Visser 2009

implicit none

integer, parameter, private :: nrow = 42, ncol = 47

double precision, dimension(nrow), parameter, private :: &
  !logN_H2 = (/0, 19, 20, 21, 22, 23/)
  logN_H2 = (/ &
    0.,          15., 15.20002927, 15.40001964, 15.59999218, &
    15.80002936, 16., 16.20002927, 16.40001964, 16.59999218, &
    16.80002936, 17., 17.20002927, 17.40001964, 17.59999218, &
    17.80002936, 18., 18.20002927, 18.40001964, 18.59999218, &
    18.80002936, 19., 19.20002927, 19.40001964, 19.59999218, &
    19.80002936, 20., 20.20002927, 20.40001964, 20.59999218, &
    20.80002936, 21., 21.20002927, 21.40001964, 21.59999218, &
    21.80002936, 22., 22.20002927, 22.40001964, 22.59999218, &
    22.80002936, 23. /)

double precision, dimension(ncol), parameter, private :: &
  !logN_12CO = (/0, 13, 14, 15, 16, 17, 18, 19/)
  logN_12CO = (/ &
  0.         , 10.        , 10.20002927, 10.40001964, 10.59999218, 10.80002936, 11.        , &
  11.20002927, 11.40001964, 11.59999218, 11.80002936, 12.        , 12.20002927, 12.40001964, &
  12.59999218, 12.80002936, 13.        , 13.20002927, 13.40001964, 13.59999218, 13.80002936, &
  14.        , 14.20002927, 14.40001964, 14.59999218, 14.80002936, 15.        , 15.20002927, &
  15.40001964, 15.59999218, 15.80002936, 16.        , 16.20002927, 16.40001964, 16.59999218, &
  16.80002936, 17.        , 17.20002927, 17.40001964, 17.59999218, 17.80002936, 18.        , &
  18.20002927, 18.40001964, 18.59999218, 18.80002936, 19.         /)
! For Tex(CO) = 5 K
!double precision, dimension(ncol, nrow), parameter, private :: &
!  f_12CO = reshape((/ &
!    1.000D00, 8.080D-1, 5.250D-1, 2.434D-1, 5.467D-2, 1.362D-2, 3.378D-3, 5.240D-4, &
!    8.176D-1, 6.347D-1, 3.891D-1, 1.787D-1, 4.297D-2, 1.152D-2, 2.922D-3, 4.662D-4, &
!    7.223D-1, 5.624D-1, 3.434D-1, 1.540D-1, 3.515D-2, 9.231D-3, 2.388D-3, 3.899D-4, &
!    3.260D-1, 2.810D-1, 1.953D-1, 8.726D-2, 1.907D-2, 4.768D-3, 1.150D-3, 1.941D-4, &
!    1.108D-2, 1.081D-2, 9.033D-3, 4.441D-3, 1.102D-3, 2.644D-4, 7.329D-5, 1.437D-5, &
!    3.938D-7, 3.938D-7, 3.936D-7, 3.923D-7, 3.901D-7, 3.893D-7, 3.890D-7, 3.875D-7 /), &
!    (/ncol, nrow/))

! For Tex(CO) = 50 K
double precision, dimension(ncol, nrow), parameter, private :: &
  !f_12CO = reshape((/ &
  !  1.000E+0, 9.405E-1, 7.046E-1, 4.015E-1, 9.964E-2, 1.567E-2, 3.162E-3, 4.839E-4, &
  !  7.546E-1, 6.979E-1, 4.817E-1, 2.577E-1, 6.505E-2, 1.135E-2, 2.369E-3, 3.924E-4, &
  !  5.752E-1, 5.228E-1, 3.279E-1, 1.559E-1, 3.559E-2, 6.443E-3, 1.526E-3, 2.751E-4, &
  !  2.493E-1, 2.196E-1, 1.135E-1, 4.062E-2, 7.864E-3, 1.516E-3, 4.448E-4, 9.367E-5, &
  !  1.550E-3, 1.370E-3, 6.801E-4, 2.127E-4, 5.051E-5, 1.198E-5, 6.553E-6, 3.937E-6, &
  !  8.492E-8, 8.492E-8, 8.492E-8, 8.492E-8, 8.492E-8, 8.492E-8, 8.488E-8, 8.453E-8 /), &
  !  (/ncol, nrow/))
  f_12CO = reshape((/ &
1.000E+00, 9.999E-01, 9.999E-01, 9.998E-01, 9.997E-01, 9.996E-01, 9.993E-01, 9.989E-01, 9.983E-01, 9.974E-01, &
9.958E-01, 9.934E-01, 9.896E-01, 9.838E-01, 9.747E-01, 9.609E-01, 9.405E-01, 9.114E-01, 8.719E-01, 8.221E-01, &
7.648E-01, 7.046E-01, 6.448E-01, 5.858E-01, 5.263E-01, 4.652E-01, 4.015E-01, 3.350E-01, 2.672E-01, 2.019E-01, &
1.446E-01, 9.964E-02, 6.774E-02, 4.631E-02, 3.195E-02, 2.224E-02, 1.567E-02, 1.119E-02, 8.087E-03, 5.907E-03, &
4.334E-03, 3.162E-03, 2.270E-03, 1.593E-03, 1.090E-03, 7.299E-04, 4.839E-04, &
9.083E-01, 9.082E-01, 9.082E-01, 9.081E-01, 9.080E-01, 9.079E-01, 9.076E-01, 9.072E-01, 9.066E-01, 9.057E-01, &
9.042E-01, 9.018E-01, 8.981E-01, 8.923E-01, 8.834E-01, 8.698E-01, 8.498E-01, 8.211E-01, 7.825E-01, 7.340E-01, &
6.787E-01, 6.214E-01, 5.658E-01, 5.125E-01, 4.603E-01, 4.077E-01, 3.533E-01, 2.962E-01, 2.374E-01, 1.803E-01, &
1.299E-01, 9.003E-02, 6.167E-02, 4.250E-02, 2.955E-02, 2.070E-02, 1.465E-02, 1.049E-02, 7.592E-03, 5.553E-03, &
4.084E-03, 2.991E-03, 2.158E-03, 1.524E-03, 1.049E-03, 7.067E-04, 4.704E-04, &
9.055E-01, 9.054E-01, 9.054E-01, 9.053E-01, 9.052E-01, 9.051E-01, 9.048E-01, 9.045E-01, 9.039E-01, 9.029E-01, &
9.014E-01, 8.990E-01, 8.953E-01, 8.895E-01, 8.806E-01, 8.670E-01, 8.470E-01, 8.184E-01, 7.797E-01, 7.313E-01, &
6.760E-01, 6.187E-01, 5.632E-01, 5.100E-01, 4.580E-01, 4.055E-01, 3.513E-01, 2.944E-01, 2.359E-01, 1.792E-01, &
1.290E-01, 8.942E-02, 6.126E-02, 4.223E-02, 2.938E-02, 2.059E-02, 1.458E-02, 1.044E-02, 7.554E-03, 5.525E-03, &
4.065E-03, 2.978E-03, 2.149E-03, 1.517E-03, 1.045E-03, 7.041E-04, 4.687E-04, &
9.025E-01, 9.024E-01, 9.024E-01, 9.023E-01, 9.022E-01, 9.020E-01, 9.018E-01, 9.014E-01, 9.008E-01, 8.999E-01, &
8.984E-01, 8.960E-01, 8.923E-01, 8.865E-01, 8.776E-01, 8.640E-01, 8.440E-01, 8.154E-01, 7.768E-01, 7.283E-01, &
6.731E-01, 6.159E-01, 5.604E-01, 5.074E-01, 4.555E-01, 4.032E-01, 3.492E-01, 2.926E-01, 2.344E-01, 1.779E-01, &
1.281E-01, 8.877E-02, 6.081E-02, 4.194E-02, 2.919E-02, 2.048E-02, 1.450E-02, 1.038E-02, 7.513E-03, 5.495E-03, &
4.044E-03, 2.963E-03, 2.139E-03, 1.510E-03, 1.041E-03, 7.012E-04, 4.670E-04, &
8.992E-01, 8.991E-01, 8.991E-01, 8.990E-01, 8.989E-01, 8.988E-01, 8.985E-01, 8.981E-01, 8.975E-01, 8.966E-01, &
8.951E-01, 8.927E-01, 8.890E-01, 8.832E-01, 8.743E-01, 8.608E-01, 8.407E-01, 8.121E-01, 7.735E-01, 7.251E-01, &
6.699E-01, 6.128E-01, 5.575E-01, 5.045E-01, 4.528E-01, 4.008E-01, 3.470E-01, 2.907E-01, 2.328E-01, 1.767E-01, &
1.271E-01, 8.808E-02, 6.035E-02, 4.164E-02, 2.900E-02, 2.036E-02, 1.443E-02, 1.033E-02, 7.472E-03, 5.465E-03, &
4.022E-03, 2.948E-03, 2.129E-03, 1.504E-03, 1.036E-03, 6.983E-04, 4.652E-04, &
8.957E-01, 8.956E-01, 8.956E-01, 8.955E-01, 8.954E-01, 8.953E-01, 8.950E-01, 8.946E-01, 8.940E-01, 8.931E-01, &
8.916E-01, 8.892E-01, 8.855E-01, 8.797E-01, 8.708E-01, 8.573E-01, 8.372E-01, 8.087E-01, 7.701E-01, 7.217E-01, &
6.666E-01, 6.095E-01, 5.543E-01, 5.016E-01, 4.500E-01, 3.983E-01, 3.448E-01, 2.888E-01, 2.312E-01, 1.754E-01, &
1.261E-01, 8.740E-02, 5.989E-02, 4.134E-02, 2.882E-02, 2.024E-02, 1.435E-02, 1.027E-02, 7.432E-03, 5.435E-03, &
4.001E-03, 2.933E-03, 2.119E-03, 1.497E-03, 1.031E-03, 6.954E-04, 4.633E-04, &
8.920E-01, 8.919E-01, 8.919E-01, 8.918E-01, 8.917E-01, 8.916E-01, 8.913E-01, 8.910E-01, 8.903E-01, 8.894E-01, &
8.879E-01, 8.855E-01, 8.818E-01, 8.760E-01, 8.671E-01, 8.536E-01, 8.336E-01, 8.050E-01, 7.665E-01, 7.182E-01, &
6.631E-01, 6.061E-01, 5.511E-01, 4.985E-01, 4.472E-01, 3.957E-01, 3.425E-01, 2.868E-01, 2.296E-01, 1.741E-01, &
1.252E-01, 8.673E-02, 5.944E-02, 4.106E-02, 2.864E-02, 2.013E-02, 1.428E-02, 1.022E-02, 7.393E-03, 5.406E-03, &
3.980E-03, 2.919E-03, 2.108E-03, 1.489E-03, 1.027E-03, 6.925E-04, 4.615E-04, &
8.881E-01, 8.881E-01, 8.880E-01, 8.880E-01, 8.879E-01, 8.877E-01, 8.875E-01, 8.871E-01, 8.865E-01, 8.855E-01, &
8.840E-01, 8.817E-01, 8.779E-01, 8.722E-01, 8.633E-01, 8.498E-01, 8.298E-01, 8.012E-01, 7.627E-01, 7.144E-01, &
6.594E-01, 6.026E-01, 5.477E-01, 4.953E-01, 4.443E-01, 3.931E-01, 3.403E-01, 2.849E-01, 2.279E-01, 1.728E-01, &
1.243E-01, 8.608E-02, 5.901E-02, 4.078E-02, 2.847E-02, 2.002E-02, 1.420E-02, 1.017E-02, 7.353E-03, 5.377E-03, &
3.959E-03, 2.904E-03, 2.098E-03, 1.482E-03, 1.022E-03, 6.895E-04, 4.597E-04, &
8.840E-01, 8.840E-01, 8.839E-01, 8.839E-01, 8.838E-01, 8.836E-01, 8.834E-01, 8.830E-01, 8.824E-01, 8.815E-01, &
8.800E-01, 8.776E-01, 8.739E-01, 8.681E-01, 8.592E-01, 8.457E-01, 8.257E-01, 7.972E-01, 7.587E-01, 7.105E-01, &
6.556E-01, 5.989E-01, 5.442E-01, 4.920E-01, 4.413E-01, 3.904E-01, 3.379E-01, 2.829E-01, 2.263E-01, 1.716E-01, &
1.233E-01, 8.543E-02, 5.859E-02, 4.051E-02, 2.830E-02, 1.991E-02, 1.413E-02, 1.011E-02, 7.313E-03, 5.347E-03, &
3.937E-03, 2.888E-03, 2.087E-03, 1.475E-03, 1.017E-03, 6.864E-04, 4.578E-04, &
8.797E-01, 8.796E-01, 8.796E-01, 8.795E-01, 8.794E-01, 8.793E-01, 8.790E-01, 8.786E-01, 8.780E-01, 8.771E-01, &
8.756E-01, 8.732E-01, 8.695E-01, 8.637E-01, 8.549E-01, 8.414E-01, 8.214E-01, 7.929E-01, 7.545E-01, 7.063E-01, &
6.515E-01, 5.950E-01, 5.404E-01, 4.886E-01, 4.381E-01, 3.876E-01, 3.355E-01, 2.808E-01, 2.246E-01, 1.702E-01, &
1.224E-01, 8.478E-02, 5.816E-02, 4.024E-02, 2.812E-02, 1.980E-02, 1.405E-02, 1.006E-02, 7.271E-03, 5.316E-03, &
3.914E-03, 2.872E-03, 2.075E-03, 1.467E-03, 1.012E-03, 6.830E-04, 4.558E-04, &
8.750E-01, 8.749E-01, 8.748E-01, 8.748E-01, 8.747E-01, 8.745E-01, 8.743E-01, 8.739E-01, 8.733E-01, 8.724E-01, &
8.709E-01, 8.685E-01, 8.648E-01, 8.590E-01, 8.502E-01, 8.367E-01, 8.167E-01, 7.883E-01, 7.499E-01, 7.018E-01, &
6.471E-01, 5.907E-01, 5.364E-01, 4.848E-01, 4.348E-01, 3.846E-01, 3.329E-01, 2.786E-01, 2.228E-01, 1.689E-01, &
1.214E-01, 8.411E-02, 5.773E-02, 3.997E-02, 2.795E-02, 1.968E-02, 1.397E-02, 9.996E-03, 7.226E-03, 5.283E-03, &
3.890E-03, 2.855E-03, 2.063E-03, 1.458E-03, 1.006E-03, 6.795E-04, 4.536E-04, &
8.699E-01, 8.698E-01, 8.698E-01, 8.697E-01, 8.696E-01, 8.695E-01, 8.692E-01, 8.689E-01, 8.683E-01, 8.673E-01, &
8.658E-01, 8.634E-01, 8.597E-01, 8.540E-01, 8.451E-01, 8.317E-01, 8.117E-01, 7.833E-01, 7.450E-01, 6.970E-01, &
6.424E-01, 5.862E-01, 5.321E-01, 4.808E-01, 4.311E-01, 3.814E-01, 3.300E-01, 2.762E-01, 2.209E-01, 1.674E-01, &
1.203E-01, 8.342E-02, 5.730E-02, 3.969E-02, 2.776E-02, 1.955E-02, 1.388E-02, 9.931E-03, 7.178E-03, 5.248E-03, &
3.865E-03, 2.836E-03, 2.050E-03, 1.449E-03, 1.000E-03, 6.758E-04, 4.514E-04, &
8.645E-01, 8.644E-01, 8.644E-01, 8.643E-01, 8.642E-01, 8.641E-01, 8.638E-01, 8.635E-01, 8.629E-01, 8.619E-01, &
8.604E-01, 8.581E-01, 8.544E-01, 8.486E-01, 8.397E-01, 8.263E-01, 8.064E-01, 7.780E-01, 7.397E-01, 6.918E-01, &
6.373E-01, 5.813E-01, 5.275E-01, 4.765E-01, 4.272E-01, 3.778E-01, 3.269E-01, 2.736E-01, 2.187E-01, 1.658E-01, &
1.192E-01, 8.268E-02, 5.683E-02, 3.939E-02, 2.756E-02, 1.942E-02, 1.378E-02, 9.860E-03, 7.126E-03, 5.210E-03, &
3.837E-03, 2.816E-03, 2.036E-03, 1.440E-03, 9.939E-04, 6.719E-04, 4.490E-04, &
8.587E-01, 8.586E-01, 8.586E-01, 8.585E-01, 8.584E-01, 8.583E-01, 8.580E-01, 8.576E-01, 8.570E-01, 8.561E-01, &
8.546E-01, 8.522E-01, 8.485E-01, 8.428E-01, 8.339E-01, 8.205E-01, 8.006E-01, 7.723E-01, 7.341E-01, 6.862E-01, &
6.319E-01, 5.760E-01, 5.224E-01, 4.718E-01, 4.228E-01, 3.739E-01, 3.235E-01, 2.706E-01, 2.163E-01, 1.639E-01, &
1.179E-01, 8.186E-02, 5.632E-02, 3.906E-02, 2.734E-02, 1.926E-02, 1.367E-02, 9.782E-03, 7.069E-03, 5.168E-03, &
3.807E-03, 2.795E-03, 2.021E-03, 1.429E-03, 9.871E-04, 6.677E-04, 4.464E-04, &
8.522E-01, 8.521E-01, 8.521E-01, 8.520E-01, 8.519E-01, 8.518E-01, 8.515E-01, 8.511E-01, 8.505E-01, 8.496E-01, &
8.481E-01, 8.458E-01, 8.421E-01, 8.363E-01, 8.275E-01, 8.141E-01, 7.942E-01, 7.659E-01, 7.278E-01, 6.800E-01, &
6.258E-01, 5.701E-01, 5.168E-01, 4.665E-01, 4.180E-01, 3.695E-01, 3.195E-01, 2.672E-01, 2.135E-01, 1.618E-01, &
1.164E-01, 8.092E-02, 5.573E-02, 3.869E-02, 2.709E-02, 1.909E-02, 1.355E-02, 9.693E-03, 7.005E-03, 5.122E-03, &
3.774E-03, 2.771E-03, 2.004E-03, 1.418E-03, 9.797E-04, 6.630E-04, 4.435E-04, &
8.447E-01, 8.446E-01, 8.446E-01, 8.445E-01, 8.444E-01, 8.443E-01, 8.440E-01, 8.437E-01, 8.431E-01, 8.421E-01, &
8.406E-01, 8.383E-01, 8.346E-01, 8.288E-01, 8.200E-01, 8.066E-01, 7.868E-01, 7.586E-01, 7.205E-01, 6.729E-01, &
6.188E-01, 5.634E-01, 5.103E-01, 4.604E-01, 4.123E-01, 3.643E-01, 3.149E-01, 2.632E-01, 2.103E-01, 1.593E-01, &
1.147E-01, 7.982E-02, 5.505E-02, 3.825E-02, 2.679E-02, 1.889E-02, 1.341E-02, 9.591E-03, 6.931E-03, 5.069E-03, &
3.736E-03, 2.744E-03, 1.985E-03, 1.405E-03, 9.711E-04, 6.575E-04, 4.401E-04, &
8.358E-01, 8.357E-01, 8.357E-01, 8.356E-01, 8.355E-01, 8.354E-01, 8.351E-01, 8.347E-01, 8.341E-01, 8.332E-01, &
8.317E-01, 8.294E-01, 8.257E-01, 8.200E-01, 8.112E-01, 7.978E-01, 7.780E-01, 7.498E-01, 7.118E-01, 6.643E-01, &
6.105E-01, 5.553E-01, 5.027E-01, 4.532E-01, 4.056E-01, 3.582E-01, 3.094E-01, 2.584E-01, 2.063E-01, 1.563E-01, &
1.126E-01, 7.848E-02, 5.422E-02, 3.771E-02, 2.644E-02, 1.864E-02, 1.323E-02, 9.468E-03, 6.842E-03, 5.005E-03, &
3.689E-03, 2.710E-03, 1.961E-03, 1.389E-03, 9.608E-04, 6.510E-04, 4.361E-04, &
8.250E-01, 8.249E-01, 8.249E-01, 8.248E-01, 8.247E-01, 8.246E-01, 8.244E-01, 8.240E-01, 8.234E-01, 8.224E-01, &
8.210E-01, 8.186E-01, 8.149E-01, 8.092E-01, 8.004E-01, 7.871E-01, 7.674E-01, 7.393E-01, 7.014E-01, 6.540E-01, &
6.004E-01, 5.456E-01, 4.933E-01, 4.444E-01, 3.974E-01, 3.506E-01, 3.026E-01, 2.525E-01, 2.015E-01, 1.527E-01, &
1.101E-01, 7.683E-02, 5.318E-02, 3.705E-02, 2.599E-02, 1.833E-02, 1.302E-02, 9.314E-03, 6.731E-03, 4.925E-03, &
3.632E-03, 2.669E-03, 1.933E-03, 1.369E-03, 9.480E-04, 6.429E-04, 4.309E-04, &
8.119E-01, 8.118E-01, 8.118E-01, 8.117E-01, 8.117E-01, 8.115E-01, 8.113E-01, 8.109E-01, 8.103E-01, 8.094E-01, &
8.079E-01, 8.055E-01, 8.019E-01, 7.962E-01, 7.874E-01, 7.741E-01, 7.544E-01, 7.264E-01, 6.887E-01, 6.415E-01, &
5.882E-01, 5.337E-01, 4.820E-01, 4.336E-01, 3.873E-01, 3.414E-01, 2.943E-01, 2.453E-01, 1.956E-01, 1.482E-01, &
1.069E-01, 7.477E-02, 5.187E-02, 3.619E-02, 2.541E-02, 1.794E-02, 1.274E-02, 9.118E-03, 6.590E-03, 4.823E-03, &
3.559E-03, 2.618E-03, 1.897E-03, 1.345E-03, 9.320E-04, 6.326E-04, 4.244E-04, &
7.961E-01, 7.960E-01, 7.960E-01, 7.959E-01, 7.958E-01, 7.957E-01, 7.954E-01, 7.951E-01, 7.945E-01, 7.935E-01, &
7.921E-01, 7.897E-01, 7.861E-01, 7.804E-01, 7.717E-01, 7.584E-01, 7.388E-01, 7.109E-01, 6.733E-01, 6.264E-01, &
5.734E-01, 5.193E-01, 4.681E-01, 4.205E-01, 3.750E-01, 3.301E-01, 2.841E-01, 2.366E-01, 1.884E-01, 1.427E-01, &
1.030E-01, 7.218E-02, 5.020E-02, 3.509E-02, 2.467E-02, 1.743E-02, 1.239E-02, 8.865E-03, 6.410E-03, 4.694E-03, &
3.467E-03, 2.552E-03, 1.851E-03, 1.314E-03, 9.116E-04, 6.196E-04, 4.161E-04, &
7.771E-01, 7.771E-01, 7.770E-01, 7.770E-01, 7.769E-01, 7.767E-01, 7.765E-01, 7.761E-01, 7.755E-01, 7.746E-01, &
7.731E-01, 7.708E-01, 7.672E-01, 7.615E-01, 7.528E-01, 7.396E-01, 7.201E-01, 6.923E-01, 6.549E-01, 6.082E-01, &
5.556E-01, 5.021E-01, 4.515E-01, 4.047E-01, 3.603E-01, 3.165E-01, 2.720E-01, 2.261E-01, 1.798E-01, 1.360E-01, &
9.826E-02, 6.896E-02, 4.808E-02, 3.368E-02, 2.371E-02, 1.677E-02, 1.193E-02, 8.541E-03, 6.179E-03, 4.530E-03, &
3.350E-03, 2.470E-03, 1.794E-03, 1.275E-03, 8.860E-04, 6.030E-04, 4.056E-04, &
7.546E-01, 7.546E-01, 7.545E-01, 7.545E-01, 7.544E-01, 7.542E-01, 7.540E-01, 7.536E-01, 7.531E-01, 7.521E-01, &
7.507E-01, 7.484E-01, 7.447E-01, 7.391E-01, 7.304E-01, 7.173E-01, 6.979E-01, 6.703E-01, 6.331E-01, 5.868E-01, &
5.346E-01, 4.817E-01, 4.319E-01, 3.861E-01, 3.429E-01, 3.005E-01, 2.577E-01, 2.138E-01, 1.698E-01, 1.282E-01, &
9.257E-02, 6.505E-02, 4.546E-02, 3.192E-02, 2.251E-02, 1.594E-02, 1.135E-02, 8.133E-03, 5.890E-03, 4.325E-03, &
3.205E-03, 2.369E-03, 1.724E-03, 1.227E-03, 8.542E-04, 5.824E-04, 3.924E-04, &
7.282E-01, 7.282E-01, 7.281E-01, 7.281E-01, 7.280E-01, 7.278E-01, 7.276E-01, 7.272E-01, 7.267E-01, 7.257E-01, &
7.243E-01, 7.220E-01, 7.184E-01, 7.128E-01, 7.042E-01, 6.912E-01, 6.719E-01, 6.445E-01, 6.076E-01, 5.617E-01, &
5.101E-01, 4.579E-01, 4.091E-01, 3.645E-01, 3.227E-01, 2.821E-01, 2.413E-01, 1.997E-01, 1.581E-01, 1.192E-01, &
8.592E-02, 6.039E-02, 4.228E-02, 2.976E-02, 2.103E-02, 1.491E-02, 1.063E-02, 7.629E-03, 5.535E-03, 4.075E-03, &
3.029E-03, 2.245E-03, 1.638E-03, 1.169E-03, 8.151E-04, 5.571E-04, 3.762E-04, &
6.975E-01, 6.974E-01, 6.974E-01, 6.973E-01, 6.972E-01, 6.971E-01, 6.969E-01, 6.965E-01, 6.959E-01, 6.950E-01, &
6.936E-01, 6.913E-01, 6.877E-01, 6.822E-01, 6.737E-01, 6.608E-01, 6.417E-01, 6.145E-01, 5.780E-01, 5.327E-01, &
4.819E-01, 4.306E-01, 3.831E-01, 3.399E-01, 2.998E-01, 2.612E-01, 2.228E-01, 1.838E-01, 1.451E-01, 1.090E-01, &
7.834E-02, 5.501E-02, 3.855E-02, 2.719E-02, 1.925E-02, 1.368E-02, 9.766E-03, 7.023E-03, 5.111E-03, 3.777E-03, &
2.819E-03, 2.098E-03, 1.536E-03, 1.099E-03, 7.682E-04, 5.264E-04, 3.565E-04, &
6.619E-01, 6.619E-01, 6.618E-01, 6.618E-01, 6.617E-01, 6.616E-01, 6.613E-01, 6.610E-01, 6.604E-01, 6.595E-01, &
6.581E-01, 6.558E-01, 6.523E-01, 6.469E-01, 6.385E-01, 6.257E-01, 6.069E-01, 5.801E-01, 5.442E-01, 4.997E-01, &
4.498E-01, 3.998E-01, 3.537E-01, 3.123E-01, 2.743E-01, 2.380E-01, 2.022E-01, 1.662E-01, 1.307E-01, 9.771E-02, &
6.993E-02, 4.897E-02, 3.431E-02, 2.424E-02, 1.720E-02, 1.224E-02, 8.761E-03, 6.320E-03, 4.620E-03, 3.433E-03, &
2.577E-03, 1.928E-03, 1.417E-03, 1.017E-03, 7.131E-04, 4.902E-04, 3.331E-04, &
6.213E-01, 6.212E-01, 6.212E-01, 6.211E-01, 6.210E-01, 6.209E-01, 6.207E-01, 6.203E-01, 6.197E-01, 6.189E-01, &
6.175E-01, 6.153E-01, 6.118E-01, 6.065E-01, 5.982E-01, 5.857E-01, 5.673E-01, 5.411E-01, 5.059E-01, 4.624E-01, &
4.139E-01, 3.655E-01, 3.212E-01, 2.819E-01, 2.463E-01, 2.127E-01, 1.798E-01, 1.470E-01, 1.150E-01, 8.553E-02, &
6.085E-02, 4.242E-02, 2.967E-02, 2.097E-02, 1.491E-02, 1.064E-02, 7.639E-03, 5.536E-03, 4.073E-03, 3.049E-03, &
2.306E-03, 1.736E-03, 1.282E-03, 9.237E-04, 6.498E-04, 4.483E-04, 3.059E-04, &
5.752E-01, 5.752E-01, 5.751E-01, 5.751E-01, 5.750E-01, 5.748E-01, 5.746E-01, 5.743E-01, 5.737E-01, 5.729E-01, &
5.715E-01, 5.694E-01, 5.660E-01, 5.608E-01, 5.528E-01, 5.407E-01, 5.228E-01, 4.973E-01, 4.632E-01, 4.211E-01, &
3.743E-01, 3.279E-01, 2.859E-01, 2.491E-01, 2.162E-01, 1.855E-01, 1.559E-01, 1.267E-01, 9.849E-02, 7.271E-02, &
5.136E-02, 3.559E-02, 2.482E-02, 1.753E-02, 1.248E-02, 8.934E-03, 6.443E-03, 4.702E-03, 3.491E-03, 2.639E-03, &
2.013E-03, 1.526E-03, 1.133E-03, 8.201E-04, 5.792E-04, 4.013E-04, 2.751E-04, &
5.235E-01, 5.235E-01, 5.234E-01, 5.234E-01, 5.233E-01, 5.232E-01, 5.230E-01, 5.226E-01, 5.221E-01, 5.213E-01, &
5.200E-01, 5.179E-01, 5.147E-01, 5.097E-01, 5.020E-01, 4.904E-01, 4.732E-01, 4.489E-01, 4.163E-01, 3.761E-01, &
3.316E-01, 2.878E-01, 2.486E-01, 2.147E-01, 1.848E-01, 1.574E-01, 1.313E-01, 1.058E-01, 8.160E-02, 5.974E-02, &
4.185E-02, 2.880E-02, 2.000E-02, 1.411E-02, 1.006E-02, 7.222E-03, 5.240E-03, 3.859E-03, 2.899E-03, 2.218E-03, &
1.708E-03, 1.305E-03, 9.747E-04, 7.088E-04, 5.028E-04, 3.500E-04, 2.413E-04, &
4.658E-01, 4.657E-01, 4.657E-01, 4.656E-01, 4.655E-01, 4.654E-01, 4.652E-01, 4.649E-01, 4.644E-01, 4.637E-01, &
4.624E-01, 4.605E-01, 4.575E-01, 4.528E-01, 4.456E-01, 4.346E-01, 4.185E-01, 3.957E-01, 3.652E-01, 3.276E-01, &
2.862E-01, 2.457E-01, 2.099E-01, 1.795E-01, 1.531E-01, 1.292E-01, 1.067E-01, 8.522E-02, 6.507E-02, 4.721E-02, &
3.280E-02, 2.244E-02, 1.552E-02, 1.094E-02, 7.798E-03, 5.617E-03, 4.104E-03, 3.055E-03, 2.326E-03, 1.802E-03, &
1.401E-03, 1.078E-03, 8.101E-04, 5.924E-04, 4.225E-04, 2.958E-04, 2.052E-04, &
4.010E-01, 4.010E-01, 4.009E-01, 4.009E-01, 4.008E-01, 4.007E-01, 4.005E-01, 4.003E-01, 3.998E-01, 3.991E-01, &
3.980E-01, 3.962E-01, 3.935E-01, 3.892E-01, 3.827E-01, 3.727E-01, 3.581E-01, 3.373E-01, 3.096E-01, 2.757E-01, &
2.383E-01, 2.022E-01, 1.706E-01, 1.442E-01, 1.217E-01, 1.016E-01, 8.297E-02, 6.552E-02, 4.951E-02, 3.562E-02, &
2.461E-02, 1.678E-02, 1.159E-02, 8.159E-03, 5.822E-03, 4.208E-03, 3.096E-03, 2.331E-03, 1.797E-03, 1.407E-03, &
1.103E-03, 8.531E-04, 6.449E-04, 4.743E-04, 3.404E-04, 2.399E-04, 1.676E-04, &
3.285E-01, 3.284E-01, 3.284E-01, 3.284E-01, 3.283E-01, 3.282E-01, 3.281E-01, 3.278E-01, 3.274E-01, 3.268E-01, &
3.259E-01, 3.243E-01, 3.220E-01, 3.183E-01, 3.126E-01, 3.040E-01, 2.913E-01, 2.734E-01, 2.496E-01, 2.203E-01, &
1.883E-01, 1.576E-01, 1.311E-01, 1.094E-01, 9.119E-02, 7.519E-02, 6.063E-02, 4.728E-02, 3.535E-02, 2.527E-02, &
1.744E-02, 1.191E-02, 8.250E-03, 5.818E-03, 4.160E-03, 3.019E-03, 2.237E-03, 1.699E-03, 1.323E-03, 1.044E-03, &
8.224E-04, 6.390E-04, 4.854E-04, 3.591E-04, 2.595E-04, 1.842E-04, 1.298E-04, &
2.493E-01, 2.492E-01, 2.492E-01, 2.492E-01, 2.491E-01, 2.491E-01, 2.489E-01, 2.487E-01, 2.484E-01, 2.479E-01, &
2.472E-01, 2.460E-01, 2.441E-01, 2.411E-01, 2.366E-01, 2.297E-01, 2.196E-01, 2.053E-01, 1.863E-01, 1.630E-01, &
1.377E-01, 1.135E-01, 9.301E-02, 7.647E-02, 6.287E-02, 5.112E-02, 4.062E-02, 3.124E-02, 2.312E-02, 1.647E-02, &
1.141E-02, 7.864E-03, 5.484E-03, 3.883E-03, 2.787E-03, 2.033E-03, 1.516E-03, 1.160E-03, 9.092E-04, 7.213E-04, &
5.705E-04, 4.448E-04, 3.394E-04, 2.526E-04, 1.838E-04, 1.316E-04, 9.367E-05, &
1.685E-01, 1.684E-01, 1.684E-01, 1.684E-01, 1.684E-01, 1.683E-01, 1.682E-01, 1.681E-01, 1.679E-01, 1.675E-01, &
1.670E-01, 1.661E-01, 1.648E-01, 1.627E-01, 1.595E-01, 1.547E-01, 1.475E-01, 1.374E-01, 1.240E-01, 1.076E-01, &
8.984E-02, 7.299E-02, 5.885E-02, 4.767E-02, 3.865E-02, 3.098E-02, 2.424E-02, 1.838E-02, 1.348E-02, 9.599E-03, &
6.713E-03, 4.684E-03, 3.295E-03, 2.343E-03, 1.687E-03, 1.238E-03, 9.290E-04, 7.154E-04, 5.640E-04, 4.498E-04, &
3.573E-04, 2.798E-04, 2.146E-04, 1.608E-04, 1.180E-04, 8.542E-05, 6.172E-05, &
9.530E-02, 9.529E-02, 9.528E-02, 9.527E-02, 9.525E-02, 9.521E-02, 9.516E-02, 9.508E-02, 9.496E-02, 9.476E-02, &
9.444E-02, 9.394E-02, 9.316E-02, 9.195E-02, 9.009E-02, 8.727E-02, 8.312E-02, 7.724E-02, 6.942E-02, 5.988E-02, &
4.952E-02, 3.974E-02, 3.161E-02, 2.527E-02, 2.025E-02, 1.603E-02, 1.239E-02, 9.288E-03, 6.772E-03, 4.837E-03, &
3.419E-03, 2.413E-03, 1.707E-03, 1.215E-03, 8.756E-04, 6.446E-04, 4.870E-04, 3.778E-04, 3.001E-04, 2.411E-04, &
1.930E-04, 1.522E-04, 1.177E-04, 8.904E-05, 6.622E-05, 4.881E-05, 3.620E-05, &
4.069E-02, 4.069E-02, 4.068E-02, 4.068E-02, 4.067E-02, 4.066E-02, 4.063E-02, 4.060E-02, 4.055E-02, 4.046E-02, &
4.032E-02, 4.011E-02, 3.978E-02, 3.926E-02, 3.846E-02, 3.724E-02, 3.546E-02, 3.293E-02, 2.956E-02, 2.543E-02, &
2.093E-02, 1.667E-02, 1.314E-02, 1.041E-02, 8.278E-03, 6.507E-03, 4.995E-03, 3.729E-03, 2.722E-03, 1.959E-03, &
1.399E-03, 9.940E-04, 7.027E-04, 4.976E-04, 3.576E-04, 2.642E-04, 2.015E-04, 1.583E-04, 1.275E-04, 1.038E-04, &
8.423E-05, 6.742E-05, 5.296E-05, 4.085E-05, 3.114E-05, 2.377E-05, 1.851E-05, &
1.114E-02, 1.113E-02, 1.113E-02, 1.113E-02, 1.113E-02, 1.113E-02, 1.112E-02, 1.111E-02, 1.110E-02, 1.107E-02, &
1.104E-02, 1.098E-02, 1.089E-02, 1.075E-02, 1.054E-02, 1.022E-02, 9.738E-03, 9.059E-03, 8.148E-03, 7.026E-03, &
5.793E-03, 4.613E-03, 3.624E-03, 2.861E-03, 2.268E-03, 1.781E-03, 1.371E-03, 1.032E-03, 7.635E-04, 5.585E-04, &
4.039E-04, 2.877E-04, 2.019E-04, 1.416E-04, 1.016E-04, 7.595E-05, 5.931E-05, 4.796E-05, 3.977E-05, 3.334E-05, &
2.787E-05, 2.304E-05, 1.878E-05, 1.514E-05, 1.220E-05, 9.994E-06, 8.463E-06, &
1.550E-03, 1.550E-03, 1.550E-03, 1.550E-03, 1.549E-03, 1.549E-03, 1.548E-03, 1.547E-03, 1.545E-03, 1.542E-03, &
1.537E-03, 1.530E-03, 1.519E-03, 1.501E-03, 1.473E-03, 1.432E-03, 1.370E-03, 1.281E-03, 1.162E-03, 1.012E-03, &
8.446E-04, 6.801E-04, 5.387E-04, 4.277E-04, 3.413E-04, 2.711E-04, 2.127E-04, 1.648E-04, 1.263E-04, 9.552E-05, &
7.053E-05, 5.051E-05, 3.531E-05, 2.480E-05, 1.822E-05, 1.434E-05, 1.198E-05, 1.040E-05, 9.214E-06, 8.239E-06, &
7.365E-06, 6.553E-06, 5.803E-06, 5.140E-06, 4.599E-06, 4.203E-06, 3.937E-06, &
8.249E-05, 8.249E-05, 8.248E-05, 8.247E-05, 8.246E-05, 8.244E-05, 8.241E-05, 8.236E-05, 8.228E-05, 8.215E-05, &
8.195E-05, 8.164E-05, 8.115E-05, 8.039E-05, 7.920E-05, 7.739E-05, 7.469E-05, 7.079E-05, 6.543E-05, 5.855E-05, &
5.057E-05, 4.235E-05, 3.491E-05, 2.878E-05, 2.389E-05, 1.989E-05, 1.657E-05, 1.379E-05, 1.140E-05, 9.270E-06, &
7.338E-06, 5.668E-06, 4.374E-06, 3.510E-06, 3.014E-06, 2.760E-06, 2.626E-06, 2.538E-06, 2.468E-06, 2.405E-06, &
2.344E-06, 2.281E-06, 2.219E-06, 2.161E-06, 2.112E-06, 2.076E-06, 2.051E-06, &
2.200E-06, 2.200E-06, 2.200E-06, 2.200E-06, 2.200E-06, 2.199E-06, 2.199E-06, 2.199E-06, 2.198E-06, 2.197E-06, &
2.195E-06, 2.192E-06, 2.188E-06, 2.181E-06, 2.171E-06, 2.155E-06, 2.130E-06, 2.094E-06, 2.044E-06, 1.976E-06, &
1.894E-06, 1.802E-06, 1.711E-06, 1.629E-06, 1.558E-06, 1.497E-06, 1.442E-06, 1.392E-06, 1.342E-06, 1.292E-06, &
1.241E-06, 1.195E-06, 1.159E-06, 1.136E-06, 1.124E-06, 1.118E-06, 1.116E-06, 1.115E-06, 1.113E-06, 1.112E-06, &
1.111E-06, 1.109E-06, 1.107E-06, 1.105E-06, 1.102E-06, 1.100E-06, 1.097E-06, &
5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, &
5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.490E-07, 5.489E-07, 5.489E-07, 5.488E-07, &
5.487E-07, 5.486E-07, 5.485E-07, 5.484E-07, 5.482E-07, 5.481E-07, 5.479E-07, 5.478E-07, 5.476E-07, 5.474E-07, &
5.472E-07, 5.470E-07, 5.468E-07, 5.467E-07, 5.467E-07, 5.466E-07, 5.466E-07, 5.466E-07, 5.466E-07, 5.465E-07, &
5.465E-07, 5.463E-07, 5.462E-07, 5.459E-07, 5.455E-07, 5.449E-07, 5.439E-07, &
2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, &
2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, &
2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, &
2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.356E-07, 2.355E-07, &
2.355E-07, 2.355E-07, 2.354E-07, 2.353E-07, 2.351E-07, 2.349E-07, 2.345E-07, &
8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, &
8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, &
8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, &
8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.492E-08, 8.491E-08, 8.491E-08, &
8.490E-08, 8.488E-08, 8.486E-08, 8.483E-08, 8.477E-08, 8.468E-08, 8.453E-08/), &
    (/ncol, nrow/))

contains


function get_12CO_shielding(N_H2, N_12CO)
  double precision  get_12CO_shielding, N_H2, N_12CO
  double precision logN_H2_, logN_12CO_
  integer i, i1, j1
  logN_H2_   = log10(max(N_H2, 1D0))
  logN_12CO_ = log10(max(N_12CO, 1D0))
  if (logN_H2_ .gt. logN_H2(nrow)) then
    i1 = nrow - 1
  else if (logN_H2_ .lt. logN_H2(1)) then
    i1 = 1
  else
    do i=1, nrow-1
      if ((logN_H2(i) .le. logN_H2_) .and. (logN_H2(i+1) .ge. logN_H2_)) then
        i1 = i
        exit
      end if
    end do
  end if
  if (logN_12CO_ .gt. logN_12CO(ncol)) then
    j1 = ncol - 1
  else if (logN_12CO_ .lt. logN_12CO(1)) then
    j1 = 1
  else
    do i=1, ncol-1
      if ((logN_12CO(i) .le. logN_12CO_) .and. (logN_12CO(i+1) .ge. logN_12CO_)) then
        j1 = i
        exit
      end if
    end do
  end if
  get_12CO_shielding = calc_four_point_linear_interpol( &
    logN_12CO_,    logN_H2_, &
    logN_12CO(j1), logN_12CO(j1+1), &
    logN_H2(i1),   logN_H2(i1+1), &
    log(f_12CO(j1,i1)),   log(f_12CO(j1,i1+1)), &
    log(f_12CO(j1+1,i1)), log(f_12CO(j1+1,i1+1)))
  get_12CO_shielding = exp(get_12CO_shielding)
end function get_12CO_shielding


end module load_Visser_CO_selfshielding
